{"version":3,"sources":["layers/ksj.ts","layers/gsi.ts","layers/osm.ts","layers/vt.ts","layers/baseLayers.ts","utils/AppStateHelpers.ts","utils/AppState.ts","utils/AppStateContext.tsx","AppStateProvider.tsx","layers/vtStyle/label.ts","layers/vtStyle/road.ts","layers/vtStyle/railway.ts","layers/vtStyle/index.ts","layers/vtStyle/boundary.ts","layers/vtStyle/transp.ts","img/place.svg","img/selectedPlace.svg","map/vectorStyle.ts","img/geolocation.svg","map/setGeolocation.ts","map/useMapEvent.tsx","utils/MapContext.tsx","MapProvider.tsx","map/createVectorEvent.ts","utils/fetchPages.tsx","components/Search/SearchForm.tsx","components/Snackbar.tsx","components/Search/SearchResult.tsx","components/Search/SearchedItems.tsx","layout/DrawerSearch.tsx","components/Dialog.tsx","components/FeaturesList.tsx","components/AppStateHandler.tsx","components/MapStateHandler.tsx","components/ThemeStateHandler.tsx","utils/exportGeoJSON.tsx","components/StateActions.tsx","components/Credit.tsx","layout/Drawer.tsx","layout/BottomNav.tsx","layout/index.tsx","pages/Map/MapApp.tsx","pages/Map/MapInfo.tsx","utils/useGaTrackPage.tsx","pages/Map/index.tsx","components/PageContainer.tsx","components/Search/Title.tsx","pages/Search/index.tsx","components/Loader.tsx","utils/ArticleCache.ts","utils/fetchArticle.ts","pages/Article/index.tsx","pages/Settings/index.tsx","pages/About/index.tsx","utils/ScrollToTop.tsx","App.tsx"],"names":["JapanExtent","transformExtent","waterarea","VectorTileLayer","source","VectorTileSource","format","MVTFormat","layers","url","attributions","style","Style","fill","Fill","color","extent","minResolution","gsiAttribution","cjstd","Tile","XYZ","maxZoom","minZoom","seamless","specialRelief","Group","maxResolution","transition","opacity","className","osm","OSM","layerNames","vtLayer","declutter","baseLayers","id","title","layer","baseLayerGroup","LayerGroup","map","isBaseLayer","str","isPageFeature","feature","isRecord","page","isQueryPage","hasCoords","pageFeatures","features","Array","isArray","filter","isSearchedItem","search","size","pageid","searched","searchedItems","initialAppState","geolocation","fetchStatus","fetchTitle","baseLayer","alwaysShowLabels","useInitialAppState","React","stored","localStorage","getItem","storedAppState","obj","definedProps","undefined","partialAppState","JSON","parse","reducer","state","action","type","items","Error","AppStateContext","dispatch","useAppState","useDispatch","AppStateProvider","children","appState","appDispatch","setItem","stringify","Provider","value","defaultFill","paletteType","defaultStroke","Stroke","width","defaultTextStyle","stroke","textAlign","align","textBaseline","baseline","textPos","properties","dspPos","slice","chimei","mountain","water","station","createTextStyle","resolution","annoCtg","get","includes","getProperties","fontSize","font","chimeiTextStyle","mountainTextStyle","waterTextStyle","stationTextStyle","res17","roadColor","rdCtg","motorway","ftCode","roadWidth","rnkWidth","defaultRoadWidth","Math","max","railwayWidth","snglDbl","rtCode10","defaultRailwayWidth","railwayZIndex","railState","ShinkansenColor","vtStyle","zIndex","lvOrder","roadStyle","rtCode1","code","lineDash","railwayStyle","textStyle","pos","text","Text","knj","labelStyle","boundaryStyle","name","transpStyle","vectorStyle","isSelected","styleArr","image","IconStyle","anchor","anchorXUnits","IconAnchorUnits","FRACTION","anchorYUnits","PIXELS","src","selectedPlace","Place","label","TextStyle","offsetY","push","allLabelStyle","setGeolocation","positionFeature","Feature","setStyle","Icon","accuracyFeature","on","setGeometry","getAccuracyGeometry","coordinates","getPosition","Point","geoLocationLayer","VectorLayer","VectorSource","addLayer","setVisible","getTracking","useMapEvent","eventType","listener","un","MapContext","OlMap","useMap","storaged","window","initialView","vectorLayer","view","View","zoom","center","fromLonLat","constrainRotation","controls","defaultControl","attribution","extend","Attribution","collapsible","event","getView","getZoom","getCenter","pixel","getEventPixel","originalEvent","hit","hasFeatureAtPixel","layerFilter","hitTolerance","target","getTarget","cursor","Geolocation","tracking","trackingOptions","enableHighAccuracy","projection","getProjection","MapProvider","palette","useTheme","forEachFeatureAtPixel","eventFeature","item","ftr","indexOf","singleclick","getLayers","forEach","index","setTracking","getSource","clear","addFeatures","pageToOlFeature","forEachFeature","setProperties","selected","query","join","createFirstURL","lang","encodeURI","langOrder","fetchLangLinksCoordinates","langLinks","a","length","tasks","fetch","then","res","json","Promise","all","data","hasCoordinates","result","pages","coord","missing","description","langlinks","fetchPages","useStyles","makeStyles","createStyles","root","display","paddingLeft","input","flexGrow","iconButton","padding","SearchForm","classes","setTitle","onSubmit","Paper","InputBase","placeholder","inputProps","onChange","preventDefault","currentTarget","onKeyPress","key","document","activeElement","HTMLElement","blur","Tooltip","IconButton","aria-label","onClick","MySnackbar","message","open","onClose","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","Button","theme","spacing","SearchResult","snackbarOpen","setSnackbarOpen","isExist","Set","has","Typography","variant","gutterBottom","paragraph","extract","disabled","startIcon","disableElevation","reason","SearchedItems","List","subheader","ListSubheader","ListItem","button","dense","searchItem","ListItemText","primary","searchBox","DrawerSearch","MyDialog","content","fullWidth","maxWidth","actionButton","dialogHandler","Dialog","aria-labelledby","aria-describedby","DialogContent","DialogContentText","DialogActions","defaultProps","FeaturesList","anchorEl","setAnchorEl","selectedFeature","setSelectedFeature","snackbarMessage","setSnackbarMessage","DialogOpen","setDialogOpen","menuOpen","Boolean","pathname","useLocation","history","useHistory","handleClick","handleClose","handleDialogOpen","ListItemIcon","ListItemSecondaryAction","edge","Menu","MenuItem","animate","lon","lat","duration","AppStateHandler","Switch","checked","MapStateHandler","ThemeStateHandler","toggleDarkMode","useToggleDarkMode","useGeoJSON","geometry","getCoordinate","pageTitle","featuresToGeoJSON","StateActions","actionType","setActionType","modalOpen","setModalOpen","geojson","downloadUrl","blob","Blob","URL","createObjectURL","handleModalOpen","modalAction","removeItem","dialog","TextField","multiline","rowsMax","component","download","href","Credit","Link","to","AppDrawer","Box","py","WikiLayersTitle","pathnameToValue","BottomNav","isMobile","useMediaQuery","breakpoints","down","BottomNavigation","showLabels","BottomNavigationAction","icon","progress","position","top","left","drawer","up","flexShrink","drawerPaper","paddingBottom","flexDirection","transitions","create","bottomNav","bottom","right","boxShadow","shadows","appBar","Layout","Hidden","smDown","implementation","Drawer","paper","LinearProgress","mapContainer","multiply","mixBlendMode","MapApp","mapRef","setTarget","getElementById","ref","card","MapInfo","AccordionSummary","expandIcon","aria-controls","AccordionDetails","AccordionActions","ReactGA","initialize","useGaTrackPage","path","pageview","info","MapPage","paddingTop","PageContainer","Container","disableGutters","Title","SearchPage","alignItems","justifyContent","Loader","CircularProgress","ArticleCache","cache","sessionStorage","this","toString","article","updateSessionStorage","createArticleUrl","loaderContainer","height","Article","exists","articleExists","articleStatus","setArticleStatus","nextExists","getArticle","setArticle","catch","useArticle","dangerouslySetInnerHTML","__html","Settings","rel","About","ScrollToTop","scrollTo","App","basename","Search","Map"],"mappings":"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","file":"static/js/4.a8706cf1.chunk.js","sourcesContent":["import VectorTileLayer from 'ol/layer/VectorTile';\nimport VectorTileSource from 'ol/source/VectorTile';\nimport MVTFormat from 'ol/format/MVT';\nimport Style from 'ol/style/Style';\nimport Fill from 'ol/style/Fill';\nimport { transformExtent } from 'ol/proj';\n\nconst JapanExtent = transformExtent([120, 20, 154, 46], 'EPSG:4326', 'EPSG:3857');\n\nconst waterarea = new VectorTileLayer({\n  source: new VectorTileSource({\n    format: new MVTFormat({\n      layers: ['waterarea'],\n    }),\n    url: 'https://cyberjapandata.gsi.go.jp/xyz/experimental_bvmap/{z}/{x}/{y}.pbf',\n    attributions:\n      '<a href=\"https://github.com/gsi-cyberjapan/gsimaps-vector-experiment\" target=\"_blank\" rel=”noopener noreferrer”>国土地理院</a>',\n  }),\n  style: new Style({\n    fill: new Fill({ color: '#adf' }),\n  }),\n  extent: JapanExtent,\n  minResolution: 4.77,\n});\n\nexport default waterarea;\n","import Tile from 'ol/layer/Tile';\nimport Group from 'ol/layer/Group';\nimport XYZ from 'ol/source/XYZ';\nimport { transformExtent } from 'ol/proj';\nimport waterarea from './ksj';\n\nconst gsiAttribution = '<a href=\"https://maps.gsi.go.jp/development/ichiran.html\" target=\"_blank\">地理院タイル</a>';\n\nconst JapanExtent = transformExtent([120, 20, 154, 46], 'EPSG:4326', 'EPSG:3857');\n\nexport const cjstd = new Tile({\n  source: new XYZ({\n    url: 'https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png',\n    attributions: [gsiAttribution],\n    maxZoom: 18,\n    minZoom: 2,\n  }),\n});\n\nexport const relief = new Tile({\n  source: new XYZ({\n    url: 'https://cyberjapandata.gsi.go.jp/xyz/relief/{z}/{x}/{y}.png',\n    attributions: [gsiAttribution],\n    maxZoom: 15,\n    minZoom: 5,\n  }),\n  extent: JapanExtent,\n});\n\nexport const seamless = new Tile({\n  source: new XYZ({\n    url: '//cyberjapandata.gsi.go.jp/xyz/seamlessphoto/{z}/{x}/{y}.jpg',\n    attributions: [gsiAttribution],\n    maxZoom: 18,\n    minZoom: 2,\n  }),\n});\n\nexport const specialRelief = new Group({\n  layers: [\n    new Tile({\n      source: new XYZ({\n        url: 'https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png',\n        maxZoom: 18,\n        minZoom: 2,\n      }),\n      maxResolution: 4.77,\n    }),\n    new Tile({\n      source: new XYZ({\n        url: 'https://cyberjapandata.gsi.go.jp/xyz/relief/{z}/{x}/{y}.png',\n        maxZoom: 15,\n        minZoom: 5,\n        transition: 0,\n      }),\n      extent: JapanExtent,\n      opacity: 0.7,\n    }),\n    new Tile({\n      className: 'multiply',\n      source: new XYZ({\n        url: 'https://cyberjapandata.gsi.go.jp/xyz/slopemap/{z}/{x}/{y}.png',\n        attributions: [gsiAttribution],\n        maxZoom: 15,\n        minZoom: 3,\n      }),\n      extent: JapanExtent,\n    }),\n    waterarea,\n  ],\n});\n\n/*\nspecialRelief\n  .getLayers()\n  .item(2)\n  .on('prerender', (evt) => {\n    evt.context.globalCompositeOperation = 'multiply';\n  });\n\nspecialRelief\n  .getLayers()\n  .item(2)\n  .on('postrender', (evt) => {\n    evt.context.globalCompositeOperation = 'source-over';\n  });\n*/\n","import Tile from 'ol/layer/Tile';\nimport OSM from 'ol/source/OSM';\n\nconst osm = new Tile({\n  source: new OSM({\n    attributions: ['© <a href=\"https://www.openstreetmap.org/copyright\" target=\"_blank\">OpenStreetMap</a> contributors'],\n  }),\n});\n\nexport default osm;\n","import VectorTileLayer from 'ol/layer/VectorTile';\nimport VectorTileSource from 'ol/source/VectorTile';\nimport MVTFormat from 'ol/format/MVT';\n\nexport const layerNames = ['waterarea', 'coastline', 'road', 'railway', 'boundary', 'label', 'building', 'contour', 'transp'];\n\nexport const vtLayer = new VectorTileLayer({\n  source: new VectorTileSource({\n    format: new MVTFormat({\n      layers: layerNames,\n    }),\n    url: 'https://cyberjapandata.gsi.go.jp/xyz/experimental_bvmap/{z}/{x}/{y}.pbf',\n    attributions:\n      '<a href=\"https://github.com/gsi-cyberjapan/gsimaps-vector-experiment\" target=\"_blank\" rel=”noopener noreferrer”>国土地理院</a>',\n  }),\n  declutter: true,\n});\n","import Base from 'ol/layer/Base';\nimport LayerGroup from 'ol/layer/Group';\nimport { cjstd, seamless, specialRelief } from './gsi';\nimport osm from './osm';\nimport { vtLayer } from './vt';\n\nexport type BaseLayer = 'cjstd' | 'osm' | 'specialRelief' | 'vector' | 'seamless';\n\ninterface BaseLayerItem {\n  id: BaseLayer;\n  title: string;\n  layer: Base;\n}\n\nexport const baseLayers: BaseLayerItem[] = [\n  { id: 'cjstd', title: '地理院地図', layer: cjstd },\n  { id: 'specialRelief', title: '地形スペシャル', layer: specialRelief },\n  { id: 'vector', title: '地理院地図Vector', layer: vtLayer },\n  { id: 'seamless', title: '写真', layer: seamless },\n  { id: 'osm', title: 'OpenStreetMap', layer: osm },\n];\n\nexport const baseLayerGroup = new LayerGroup({\n  layers: baseLayers.map(({ layer }) => layer),\n});\n\nexport function setVisibleBaseLayer(baseLayer: BaseLayer): void {\n  baseLayerGroup.getLayers().forEach((layer, index) => {\n    layer.setVisible(baseLayers[index].id === baseLayer);\n  });\n}\n\nexport function isBaseLayer(str: any): str is BaseLayer {\n  return str === 'cjstd' || str === 'osm' || str === 'specialRelief' || str === 'vector' || str === 'seamless';\n}\n","import { isRecord, isQueryPage, hasCoords } from './helpers';\nimport { Search, PageFeature, FetchStatus } from '../types';\n\nexport function isPageFeature(feature: any): feature is PageFeature {\n  if (!isRecord(feature)) return false;\n  const { title, page } = feature;\n  return typeof title === 'string' && isQueryPage(page) && hasCoords(page);\n}\nexport function pageFeatures(features: any): PageFeature[] | null {\n  if (!Array.isArray(features)) return null;\n  return features.filter(isPageFeature);\n}\n\nexport function isSearchedItem(search: any): search is Search {\n  if (!isRecord(search)) return false;\n  const { size, title, pageid } = search;\n  return typeof size === 'number' && typeof title === 'string';\n}\n\nexport function searched(searchedItems: any): Search[] | null {\n  if (!Array.isArray(searchedItems)) return null;\n  return searchedItems.filter(isSearchedItem);\n}\n\nexport function isFetchStatus(str: any): str is FetchStatus {\n  if (typeof str !== 'string') return false;\n  return str === 'fetching' || str === 'success' || str === 'failure' || str === 'yet';\n}\n","import * as React from 'react';\nimport { BaseLayer, isBaseLayer } from '../layers/baseLayers';\nimport { isRecord, isQueryPage, definedProps } from './helpers';\nimport { pageFeatures, searched, isFetchStatus } from './AppStateHelpers';\nimport { QueryPage, Search, PageFeature, FetchStatus } from '../types';\n\nexport interface AppState {\n  features: PageFeature[];\n  geolocation: boolean;\n  fetchStatus: FetchStatus;\n  fetchTitle: string | null;\n  searchedItems: Search[];\n  page: QueryPage | null;\n  baseLayer: BaseLayer;\n  alwaysShowLabels: boolean;\n}\n\nexport type Action =\n  | { type: 'TOGGLE_GEOLOCATION' }\n  | { type: 'FETCH'; fetchStatus: FetchStatus; fetchTitle?: string }\n  | { type: 'CLEAR_SEARCHEDITEMS' }\n  | { type: 'SET_SEARCHEDITEMS'; items: Search[] }\n  | { type: 'SET_PAGE'; page: QueryPage | null }\n  | { type: 'ADD_FEATURE'; feature: PageFeature }\n  | { type: 'DELETE_FEATURE'; feature: PageFeature }\n  | { type: 'CLEAR_FEATURES' }\n  | { type: 'SET_BASELAYER'; layer: BaseLayer }\n  | { type: 'TOGGLE_ALWAYSSHOWLABELS' }\n  | { type: 'RESET' };\n\nexport const initialAppState: AppState = {\n  features: [],\n  geolocation: false,\n  fetchStatus: 'yet',\n  fetchTitle: null,\n  page: null,\n  searchedItems: [],\n  baseLayer: 'vector',\n  alwaysShowLabels: false,\n};\n\nfunction partialAppState(obj: any): Partial<AppState> {\n  if (!isRecord(obj)) return {};\n  const { features, geolocation, fetchStatus, fetchTitle, page, searchedItems, baseLayer, alwaysShowLabels } = obj;\n  return definedProps({\n    features: pageFeatures(features) ?? undefined,\n    geolocation: typeof geolocation === 'boolean' ? geolocation : undefined,\n    fetchStatus: isFetchStatus(fetchStatus) ? fetchStatus : undefined,\n    fetchTitle: typeof fetchTitle === 'string' ? fetchTitle : undefined,\n    page: isQueryPage(page) ? page : undefined,\n    searchedItems: searched(searchedItems) ?? undefined,\n    baseLayer: isBaseLayer(baseLayer) ? baseLayer : undefined,\n    alwaysShowLabels: typeof alwaysShowLabels === 'boolean' ? alwaysShowLabels : undefined,\n  });\n}\n\nexport function useInitialAppState(): AppState {\n  return React.useMemo(\n    () => {\n      const stored = localStorage.getItem('wikilayers:AppState');\n      const storedAppState = stored ? partialAppState(JSON.parse(stored)) : null;\n      return storedAppState\n        ? {\n            ...initialAppState,\n            ...storedAppState,\n          }\n        : initialAppState;\n    },\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    []\n  );\n}\n\nexport function reducer(state: AppState, action: Action): AppState {\n  switch (action.type) {\n    case 'TOGGLE_GEOLOCATION':\n      return {\n        ...state,\n        geolocation: !state.geolocation,\n      };\n    case 'FETCH':\n      return {\n        ...state,\n        fetchStatus: action.fetchStatus,\n        fetchTitle: action.fetchTitle ?? state.fetchTitle,\n      };\n    case 'SET_PAGE':\n      return {\n        ...state,\n        page: action.page,\n      };\n    case 'CLEAR_SEARCHEDITEMS':\n      return {\n        ...state,\n        searchedItems: [],\n      };\n    case 'SET_SEARCHEDITEMS':\n      return {\n        ...state,\n        searchedItems: action.items,\n      };\n    case 'ADD_FEATURE':\n      return {\n        ...state,\n        features: [...state.features, action.feature],\n      };\n    case 'DELETE_FEATURE':\n      return {\n        ...state,\n        features: state.features.filter((feature) => feature.page.title !== action.feature.page.title),\n      };\n    case 'CLEAR_FEATURES':\n      return {\n        ...state,\n        features: [],\n      };\n    case 'SET_BASELAYER':\n      return {\n        ...state,\n        baseLayer: action.layer,\n      };\n    case 'TOGGLE_ALWAYSSHOWLABELS':\n      return {\n        ...state,\n        alwaysShowLabels: !state.alwaysShowLabels,\n      };\n    case 'RESET':\n      return initialAppState;\n    default:\n      throw new Error();\n  }\n}\n","import * as React from 'react';\n\nimport { initialAppState, AppState, Action } from './AppState';\n\nexport const AppStateContext = React.createContext<{\n  state: AppState;\n  dispatch: React.Dispatch<Action>;\n}>({\n  state: initialAppState,\n  dispatch: () => {\n    throw new Error();\n  },\n});\n\nexport function useAppState(): AppState {\n  const { state } = React.useContext(AppStateContext);\n  return state;\n}\n\nexport function useDispatch(): React.Dispatch<Action> {\n  const { dispatch } = React.useContext(AppStateContext);\n  return dispatch;\n}\n","import * as React from 'react';\nimport { reducer, useInitialAppState } from './utils/AppState';\nimport { AppStateContext } from './utils/AppStateContext';\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nfunction AppStateProvider({ children }: Props): JSX.Element {\n  const initialAppState = useInitialAppState();\n  const [appState, appDispatch] = React.useReducer(reducer, initialAppState);\n\n  React.useEffect(() => {\n    localStorage.setItem('wikilayers:AppState', JSON.stringify(appState));\n  }, [appState]);\n\n  return <AppStateContext.Provider value={{ state: appState, dispatch: appDispatch }}>{children}</AppStateContext.Provider>;\n}\n\nexport default AppStateProvider;\n","import { FeatureLike } from 'ol/Feature';\nimport Style from 'ol/style/Style';\nimport Text, { Options as TextOptions } from 'ol/style/Text';\nimport Fill from 'ol/style/Fill';\nimport Stroke from 'ol/style/Stroke';\nimport { PaletteType } from '@material-ui/core';\n\nfunction defaultFill(paletteType: PaletteType = 'light') {\n  return new Fill({ color: paletteType === 'light' ? '#777' : '#eee' });\n}\nfunction defaultStroke(paletteType: PaletteType = 'light') {\n  return new Stroke({ color: paletteType === 'light' ? '#fff' : '#777', width: 2 });\n}\n\nfunction defaultTextStyle(paletteType: PaletteType = 'light'): TextOptions {\n  return {\n    fill: defaultFill(paletteType),\n    stroke: defaultStroke(paletteType),\n  };\n}\n\nfunction textAlign(align: string): CanvasTextAlign {\n  if (align === 'L') return 'left';\n  return align === 'R' ? 'right' : 'center';\n}\nfunction textBaseline(baseline: string): CanvasTextBaseline {\n  if (baseline === 'T') return 'top';\n  return baseline === 'B' ? 'bottom' : 'middle';\n}\n\nfunction textPos(properties: Record<string, string>): [CanvasTextAlign, CanvasTextBaseline] {\n  if (!properties || !('dspPos' in properties)) return ['center', 'middle'];\n  const { dspPos } = properties;\n  const align = dspPos.slice(0, 1);\n  const baseline = dspPos.slice(1, 2);\n\n  return [textAlign(align), textBaseline(baseline)];\n}\n\n// 110: 市区町村, 130: 郡, 140: 都道府県, 210: 公称(町字名), 220: 集落名称(通称)\nconst chimei = [110, 130, 140, 210, 220];\nfunction chimeiTextStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType = 'light'): TextOptions {\n  const { annoCtg } = feature.getProperties();\n  const fontSize = annoCtg === 110 || annoCtg === 130 || annoCtg === 140 ? 'large' : 'x-small';\n  return {\n    ...defaultTextStyle(paletteType),\n    font: `${fontSize} sans-serif`,\n  };\n}\n\n// 311, 1311, 2311: 山の総称, 312, 1312, 2312: 山、岳、峰等\n// 333, 1333, 2333: 山脈、山地\nconst mountain = [311, 1311, 2311, 312, 1312, 2312, 333, 1333, 2333];\nfunction mountainTextStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType = 'light'): TextOptions {\n  return {\n    fill: new Fill({\n      color: paletteType === 'light' ? '#755' : '#ecc',\n    }),\n    stroke: defaultStroke(paletteType),\n  };\n}\n\n// 321, 1321, 2321: 湖、沼、池、浦等, 322, 1322, 2322: 河川、用水等\n// 344, 1344, 2344: 海、灘, 湾、淵、浦、瀬、海峡、瀬戸等: 345, 1345, 2345\n// 346: 半島, 347: 海岸、浜、洲、干潟, 343: 岬、鼻、崎、磯、敷等\n// 351: 群島, 352: 島 431: 港湾 432: 港湾施設 521: ダム\nconst water = [\n  321,\n  1321,\n  2321,\n  322,\n  1322,\n  2322,\n  344,\n  1344,\n  2344,\n  345,\n  1345,\n  2345,\n  346,\n  347,\n  343,\n  351,\n  1351,\n  2351,\n  352,\n  1352,\n  2352,\n  431,\n  1431,\n  2431,\n  432,\n  521,\n];\nfunction waterTextStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType = 'light'): TextOptions {\n  const { annoCtg } = feature.getProperties();\n  const fontSize = annoCtg === 321 || annoCtg === 344 ? 'small' : 'x-small';\n\n  return {\n    fill: new Fill({\n      color: paletteType === 'light' ? '#689' : '#cce',\n    }),\n    stroke: defaultStroke(paletteType),\n    font: `${fontSize} sans-serif`,\n  };\n}\n\n// 422: 鉄道駅名\nconst station = [422];\nfunction stationTextStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType = 'light'): TextOptions {\n  return {\n    ...defaultTextStyle(paletteType),\n    font: `${paletteType === 'light' ? 'bold' : 'normal'} x-small sans-serif`,\n  };\n}\n\nfunction createTextStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType) {\n  const { annoCtg } = feature.get('annoCtg');\n  if (chimei.includes(annoCtg)) return chimeiTextStyle(feature, resolution, paletteType);\n  if (mountain.includes(annoCtg)) return mountainTextStyle(feature, resolution, paletteType);\n  if (water.includes(annoCtg)) return waterTextStyle(feature, resolution, paletteType);\n  if (station.includes(annoCtg)) return stationTextStyle(feature, resolution, paletteType);\n  return defaultTextStyle(paletteType);\n}\n\nexport default function labelStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType = 'light'): Style | Style[] {\n  const properties = feature.getProperties();\n\n  if (![...chimei, ...mountain, ...water, ...station, 681].includes(properties?.annoCtg)) return new Style();\n\n  const textStyle = createTextStyle(feature, resolution, paletteType);\n  const pos = textPos(properties);\n  return new Style({\n    text: new Text({\n      ...textStyle,\n      text: properties.knj,\n      textAlign: pos[0],\n      textBaseline: pos[1],\n    }),\n    zIndex: 10,\n  });\n}\n","import { FeatureLike } from 'ol/Feature';\nimport Style from 'ol/style/Style';\nimport Stroke from 'ol/style/Stroke';\nimport { PaletteType } from '@material-ui/core';\n\nconst res15 = 4.78;\nconst res17 = 1.19;\n\n// motorway: 0 高速道路以外, 1 高速道路, 9 不明\n// rdCtg: 0 国道, 1 都道府県道, 2 市区町村道, 3 高速自動車国道等, 5 その他, 6 不明\nfunction roadColor(feature: FeatureLike, resolution: number, paletteType: PaletteType = 'light') {\n  const { rdCtg, motorway, ftCode } = feature.getProperties();\n  if (motorway === 1 || ftCode === 52703 || ftCode === 52704) return paletteType === 'light' ? '#3a3' : '#575';\n  if (rdCtg === 3) return paletteType === 'light' ? '#3a3' : '#575';\n  if (rdCtg === 0 || ftCode === 52701 || ftCode === 52702) return paletteType === 'light' ? '#fb9' : '#753';\n  if (rdCtg === 1) return paletteType === 'light' ? '#cc9' : '#663';\n  if (rdCtg === 2) return paletteType === 'light' ? '#ccc' : '#555';\n\n  return paletteType === 'light' ? '#ddd' : '#444';\n}\n\n// rnkWidth: 0: 3m未満, 1: 3m以上5.5m未満, 2: 5.5m以上13m未満\n// 3: 13m以上19.5m未満, 4: 19.5m以上 5: その他, 6: 不明\nfunction defaultRoadWidth(feature: FeatureLike) {\n  const { rnkWidth, rdCtg } = feature.getProperties();\n  if (rnkWidth === undefined) return rdCtg === 0 || rdCtg === 2 ? 2 : 1;\n  if (rnkWidth === 4) return 3;\n  if (rnkWidth === 3 || rnkWidth === 2) return 2;\n  return rnkWidth === 1 ? 1 : 0.5;\n}\n\nfunction roadWidth(feature: FeatureLike, resolution: number) {\n  const width = defaultRoadWidth(feature);\n  return resolution > res17 ? width * Math.max(res15 / resolution, 1) : 2;\n}\n\nexport default function roadStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType = 'light'): Style {\n  const color = roadColor(feature, resolution, paletteType);\n  const width = roadWidth(feature, resolution);\n  const { lvOrder, rdCtg } = feature.getProperties();\n\n  if (resolution < res17 && rdCtg !== undefined) return new Style();\n  return new Style({\n    stroke: new Stroke({\n      width,\n      color,\n    }),\n    zIndex: lvOrder ?? 2,\n  });\n}\n","import { FeatureLike } from 'ol/Feature';\nimport Style from 'ol/style/Style';\nimport Stroke from 'ol/style/Stroke';\nimport { PaletteType } from '@material-ui/core';\n\nconst res15 = 4.78;\nconst res17 = 1.19;\n\n/** rtCode10: string\n * 0 新幹線及び地下鉄以外\n * 1 新幹線\n * 2 地下鉄\n */\n\n/** snglDbl\n *  0 非表示\n *  1 単線\n *  2 複線以上\n *  3 側線\n *  4 駅部分\n */\nfunction defaultRailwayWidth(feature: FeatureLike) {\n  const { snglDbl, rtCode10 } = feature.getProperties();\n  if (rtCode10 === '1') return 4;\n  return snglDbl === 2 ? 2 : 1;\n}\n\nfunction railwayWidth(feature: FeatureLike, resolution: number): number {\n  const width = defaultRailwayWidth(feature);\n  return resolution > res17 ? width * Math.max(res15 / resolution, 1) : 2;\n}\n\n/** railState\n * 0 地上\n * 100 トンネル\n * 200 雪覆い\n * 300 地下\n * 400 路面\n * 500 坑口無しトンネル\n *\n * 0 通常部\n * 1 橋・高架\n * 2 トンネル\n * 3 地下\n * 4 雪覆い\n * 5 運休中\n * 6 その他\n * 7 不明\n */\nfunction railwayZIndex(feature: FeatureLike) {\n  const { railState } = feature.getProperties();\n  if (railState === 100 || railState === 200 || railState === 300 || railState === 2 || railState === 3 || railState === 4) return 1;\n  return railState === 1 ? 10 : 3;\n}\n\nfunction ShinkansenColor(rtCode10: string, paletteType: PaletteType) {\n  if (rtCode10 === '1') return '#77f';\n  return paletteType === 'light' ? '#777' : '#555';\n}\n\nexport default function railwayStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType = 'light'): Style | Style[] {\n  const { snglDbl, rtCode10, rtCode1 } = feature.getProperties();\n  if (snglDbl === 0) return new Style();\n  if (snglDbl === 4)\n    return new Style({\n      stroke: new Stroke({\n        color: '#c9c',\n        width: 5,\n      }),\n      zIndex: 10,\n    });\n  const width = railwayWidth(feature, resolution);\n  const code = rtCode1?.slice(0, 5);\n\n  if (code === '40203') return new Style();\n  if (code === '40201' || code === '40216')\n    return [\n      new Style({\n        stroke: new Stroke({\n          color: ShinkansenColor(rtCode10, paletteType),\n          width: width + 1,\n        }),\n        zIndex: railwayZIndex(feature),\n      }),\n      new Style({\n        stroke: new Stroke({\n          width,\n          color: paletteType === 'light' ? '#ddd' : '#777',\n          lineDash: [4, 8],\n        }),\n        zIndex: railwayZIndex(feature),\n      }),\n    ];\n\n  return new Style({\n    stroke: new Stroke({\n      width,\n      color: paletteType === 'light' ? '#777' : '#555',\n    }),\n    zIndex: railwayZIndex(feature),\n  });\n}\n","import { FeatureLike } from 'ol/Feature';\nimport Style from 'ol/style/Style';\nimport Fill from 'ol/style/Fill';\nimport Stroke from 'ol/style/Stroke';\nimport { PaletteType } from '@material-ui/core';\nimport labelStyle from './label';\nimport roadStyle from './road';\nimport railwayStyle from './railway';\nimport boundaryStyle from './boundary';\nimport transpStyle from './transp';\nimport { layerNames } from '../vt';\n\nexport default function vtStyle(paletteType: PaletteType) {\n  return (feature: FeatureLike, resolution: number): Style | Style[] => {\n    const properties = feature.getProperties();\n    const { layer } = properties;\n    if (!layerNames.includes(layer)) return new Style();\n    if (layer === 'waterarea')\n      return new Style({\n        fill: new Fill({\n          color: paletteType === 'light' ? '#acf' : '#346',\n        }),\n        zIndex: 0,\n      });\n    if (layer === 'coastline')\n      return new Style({\n        stroke: new Stroke({\n          width: 2,\n          color: paletteType === 'light' ? '#acf' : '#346',\n        }),\n        zIndex: 0,\n      });\n    if (layer === 'road') return roadStyle(feature, resolution, paletteType);\n    if (layer === 'railway') return railwayStyle(feature, resolution, paletteType);\n    if (layer === 'label') return labelStyle(feature, resolution, paletteType);\n    if (layer === 'boundary') return boundaryStyle(feature, resolution, paletteType);\n    if (layer === 'transp') return transpStyle(feature, resolution, paletteType);\n    if (layer === 'contour')\n      return new Style({\n        stroke: new Stroke({\n          color: paletteType === 'light' ? '#edd' : '#433',\n        }),\n        zIndex: 1,\n      });\n    if (layer === 'building')\n      return new Style({\n        fill: new Fill({\n          color: paletteType === 'light' ? '#ddc' : '#444',\n        }),\n        zIndex: 4,\n      });\n    return new Style();\n  };\n}\n","import { FeatureLike } from 'ol/Feature';\nimport Style from 'ol/style/Style';\nimport Stroke from 'ol/style/Stroke';\nimport { PaletteType } from '@material-ui/core';\n\nexport default function boundaryStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType): Style {\n  return new Style({\n    stroke: new Stroke({\n      color: paletteType === 'light' ? '#aaa' : '#777',\n      width: 2,\n      lineDash: [2, 6],\n    }),\n  });\n}\n","import Style from 'ol/style/Style';\nimport { FeatureLike } from 'ol/Feature';\nimport Text from 'ol/style/Text';\nimport Stroke from 'ol/style/Stroke';\nimport Fill from 'ol/style/Fill';\nimport { PaletteType } from '@material-ui/core';\n\nexport default function transpStyle(feature: FeatureLike, resolution: number, paletteType: PaletteType): Style {\n  const { ftCode, name } = feature.getProperties();\n  if (ftCode === 2904) return new Style();\n  // declutter: true\n  if (ftCode === 2901) return new Style();\n  // if (ftCode === 2941 || ftCode === 2942 || ftCode === 2945)\n  return new Style({\n    text: new Text({\n      text: name,\n      textBaseline: 'middle',\n      textAlign: 'center',\n      font: `${paletteType === 'light' ? 'bold' : 'normal'} x-small sans-serif`,\n      stroke: new Stroke({\n        color: '#575',\n        width: 2,\n      }),\n      fill: new Fill({\n        color: paletteType === 'light' ? '#fff' : '#eee',\n      }),\n    }),\n    zIndex: 11,\n  });\n  /*\n  if (nRNo === 0) return new Style();\n  return [\n    new Style({\n      image: new RegularShape({\n        points: 3,\n        radius: 12,\n        angle: Math.PI,\n        fill: new Fill({\n          color: paletteType === 'light' ? '#44f' : '#339',\n        }),\n      }),\n      zIndex: 10,\n    }),\n    new Style({\n      text: new Text({\n        text: nRNo.toString(),\n        textBaseline: 'middle',\n        textAlign: 'center',\n        font: `bold xx-small monospace`,\n        stroke: new Stroke({\n          color: paletteType === 'light' ? '#44f' : '#339',\n          width: 2,\n        }),\n        fill: new Fill({\n          color: '#fff',\n        }),\n      }),\n      zIndex: 11,\n    }),\n  ];\n  */\n}\n\n/** ftCode: number\n *  2901: 国道番号 nRNo\n *  2904: 高速道路番号 nRNo\n *  2941: インターチェンジ name\n *  2942: ジャンクション name\n *  2945: スマートインターチェンジ name\n */\n","export default __webpack_public_path__ + \"static/media/place.5c0f421e.svg\";","export default __webpack_public_path__ + \"static/media/selectedPlace.1ab15dff.svg\";","import Style from 'ol/style/Style';\nimport IconStyle from 'ol/style/Icon';\nimport TextStyle from 'ol/style/Text';\nimport Fill from 'ol/style/Fill';\nimport Stroke from 'ol/style/Stroke';\nimport { FeatureLike } from 'ol/Feature';\nimport IconAnchorUnits from 'ol/style/IconAnchorUnits';\nimport Place from '../img/place.svg';\nimport selectedPlace from '../img/selectedPlace.svg';\n\nexport function vectorStyle(feature: FeatureLike, resolution: number): Style | Style[] {\n  if (!feature.get('visibility')) return new Style();\n  const isSelected = feature.get('selected');\n  const styleArr = [\n    new Style({\n      zIndex: isSelected ? 110 : 101,\n      image: new IconStyle({\n        anchor: [0.5, 24],\n        anchorXUnits: IconAnchorUnits.FRACTION,\n        anchorYUnits: IconAnchorUnits.PIXELS,\n        src: isSelected ? selectedPlace : Place,\n      }),\n    }),\n  ];\n  const label = new Style({\n    zIndex: isSelected ? 110 : 101,\n    text: new TextStyle({\n      text: feature.get('title'),\n      font: `bold 12px sans-serif`,\n      offsetY: 8,\n      fill: new Fill({\n        color: 'white',\n      }),\n      stroke: new Stroke({\n        color: '#333',\n        width: 3,\n      }),\n    }),\n  });\n\n  if (resolution < 610 && !isSelected) {\n    styleArr.push(label);\n  } else if (resolution > 610 && isSelected) {\n    styleArr.push(label);\n  }\n  return styleArr;\n}\n\nexport function allLabelStyle(feature: FeatureLike): Style | Style[] {\n  if (!feature.get('visibility')) return new Style();\n  const isSelected = feature.get('selected');\n  return [\n    new Style({\n      zIndex: isSelected ? 110 : 101,\n      image: new IconStyle({\n        anchor: [0.5, 24],\n        anchorXUnits: IconAnchorUnits.FRACTION,\n        anchorYUnits: IconAnchorUnits.PIXELS,\n        src: isSelected ? selectedPlace : Place,\n      }),\n    }),\n    new Style({\n      zIndex: isSelected ? 110 : 101,\n      text: new TextStyle({\n        text: feature.get('title'),\n        font: `bold 12px sans-serif`,\n        offsetY: 8,\n        fill: new Fill({\n          color: 'white',\n        }),\n        stroke: new Stroke({\n          color: isSelected ? 'blue' : '#333',\n          width: 3,\n        }),\n      }),\n    }),\n  ];\n}\n","export default __webpack_public_path__ + \"static/media/geolocation.38ff5d27.svg\";","import OlMap from 'ol/Map';\nimport Feature from 'ol/Feature';\nimport Style from 'ol/style/Style';\nimport Fill from 'ol/style/Fill';\nimport Stroke from 'ol/style/Stroke';\nimport IconStyle from 'ol/style/Icon';\nimport VectorLayer from 'ol/layer/Vector';\nimport VectorSource from 'ol/source/Vector';\nimport Point from 'ol/geom/Point';\nimport Geolocation from 'ol/Geolocation';\n\nimport Icon from '../img/geolocation.svg';\n\nfunction setGeolocation(map: OlMap, geolocation: Geolocation): void {\n  const positionFeature = new Feature();\n  positionFeature.setStyle(\n    new Style({\n      image: new IconStyle({\n        src: Icon,\n      }),\n    })\n  );\n\n  const accuracyFeature = new Feature();\n  accuracyFeature.setStyle(\n    new Style({\n      fill: new Fill({\n        color: 'rgba(255, 255, 255, 0.2)',\n      }),\n      stroke: new Stroke({\n        color: 'rgba(2, 119, 189, 0.6)',\n        width: 2,\n      }),\n    })\n  );\n  geolocation.on('change:accuracyGeometry', () => {\n    accuracyFeature.setGeometry(geolocation.getAccuracyGeometry());\n  });\n\n  geolocation.on('change:position', () => {\n    const coordinates = geolocation.getPosition();\n    if (coordinates) {\n      positionFeature.setGeometry(new Point(coordinates));\n    }\n  });\n\n  const geoLocationLayer = new VectorLayer({\n    source: new VectorSource({\n      features: [accuracyFeature, positionFeature],\n    }),\n  });\n  map.addLayer(geoLocationLayer);\n\n  geolocation.on('change:tracking', () => {\n    geoLocationLayer.setVisible(geolocation.getTracking());\n  });\n}\n\nexport default setGeolocation;\n","import * as React from 'react';\nimport OlMap from 'ol/Map';\nimport MapBrowserEvent from 'ol/MapBrowserEvent';\n\nfunction useMapEvent(map: OlMap, eventType: string | string[], listener: (evt: MapBrowserEvent) => void): void {\n  React.useEffect(() => {\n    map.on(eventType, listener);\n    return () => map.un(eventType, listener);\n  }, [map, eventType, listener]);\n}\n\nexport default useMapEvent;\n","import * as React from 'react';\nimport OlMap from 'ol/Map';\n\nexport const MapContext = React.createContext<OlMap>(new OlMap({}));\n\nexport function useMap(): OlMap {\n  const map = React.useContext(MapContext);\n  return map;\n}\n","import * as React from 'react';\nimport OlMap from 'ol/Map';\nimport View from 'ol/View';\nimport VectorLayer from 'ol/layer/Vector';\nimport VectorSource from 'ol/source/Vector';\nimport Geolocation from 'ol/Geolocation';\nimport { Attribution, defaults as defaultControl } from 'ol/control';\nimport { fromLonLat } from 'ol/proj';\nimport { useTheme } from '@material-ui/core/styles';\n\nimport { baseLayerGroup, setVisibleBaseLayer } from './layers/baseLayers';\nimport { vtLayer } from './layers/vt';\nimport vtStyle from './layers/vtStyle';\nimport { vectorStyle, allLabelStyle } from './map/vectorStyle';\nimport setGeolocation from './map/setGeolocation';\nimport { singleclick, pointermove } from './map/createVectorEvent';\nimport useMapEvent from './map/useMapEvent';\nimport { pageToOlFeature } from './utils/helpers';\nimport { MapContext } from './utils/MapContext';\nimport { useAppState, useDispatch } from './utils/AppStateContext';\n\nimport './map/ol.css';\nimport './map/blend.css';\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nconst storaged = window.localStorage.getItem('wikilayers:view');\nconst initialView = storaged ? JSON.parse(storaged) : null;\n\nconst vectorLayer = new VectorLayer({\n  source: new VectorSource({\n    attributions: ['<a href=\"https://ja.wikipedia.org\" target=\"_blank\">Wikipedia</a>'],\n  }),\n});\n\nconst map = new OlMap({\n  view: new View({\n    zoom: initialView?.zoom ?? 13,\n    center: initialView?.center ?? fromLonLat([140.4606, 36.3703]),\n    constrainRotation: 4,\n  }),\n  layers: [baseLayerGroup, vectorLayer],\n  controls: defaultControl({\n    attribution: false,\n  }).extend([\n    new Attribution({\n      collapsible: false,\n    }),\n  ]),\n});\n\nmap.on('moveend', (event) => {\n  const view = event.map.getView();\n  window.localStorage.setItem('wikilayers:view', JSON.stringify({ zoom: view.getZoom(), center: view.getCenter() }));\n});\nmap.on('pointermove', pointermove);\n\nconst geolocation = new Geolocation({\n  tracking: false,\n  trackingOptions: {\n    enableHighAccuracy: true,\n  },\n  projection: map.getView().getProjection(),\n});\n\nsetGeolocation(map, geolocation);\n\nfunction MapProvider({ children }: Props): JSX.Element {\n  const appState = useAppState();\n  const dispatch = useDispatch();\n  const { palette } = useTheme();\n\n  useMapEvent(map, 'singleclick', singleclick(appState, dispatch));\n\n  React.useEffect(() => {\n    setVisibleBaseLayer(appState.baseLayer);\n  }, [appState.baseLayer]);\n  React.useEffect(() => {\n    geolocation.setTracking(appState.geolocation);\n  }, [appState.geolocation]);\n  React.useEffect(() => {\n    vtLayer.setStyle(vtStyle(palette.type));\n  }, [palette.type]);\n  React.useEffect(() => {\n    vectorLayer.getSource().clear();\n    vectorLayer.getSource().addFeatures(appState.features.map((feature) => pageToOlFeature(feature)));\n  }, [appState.features]);\n  React.useEffect(() => {\n    vectorLayer.getSource().forEachFeature((feature) => {\n      feature.setProperties({\n        selected: feature.get('pageTitle') === appState.page?.title,\n      });\n    });\n  }, [appState.page, appState.features]);\n  React.useEffect(() => {\n    vectorLayer.setStyle(appState.alwaysShowLabels ? allLabelStyle : vectorStyle);\n  }, [appState.alwaysShowLabels]);\n\n  return <MapContext.Provider value={map}>{children}</MapContext.Provider>;\n}\n\nexport default MapProvider;\n","import * as React from 'react';\nimport VectorLayer from 'ol/layer/Vector';\nimport MapBrowserEvent from 'ol/MapBrowserEvent';\nimport { AppState, Action } from '../utils/AppState';\n\nexport function singleclick(appState: AppState, dispatch: React.Dispatch<Action>): (event: MapBrowserEvent) => void {\n  const { features, page } = appState;\n  return (event: MapBrowserEvent) => {\n    const { map } = event;\n    const feature = map.forEachFeatureAtPixel(event.pixel, (eventFeature) => eventFeature, {\n      hitTolerance: 10,\n      layerFilter: (layer) => layer instanceof VectorLayer,\n    });\n    if (feature) {\n      const pageid: number = feature.get('pageid');\n      const item = features[features.map((ftr) => ftr.page.pageid).indexOf(pageid)];\n\n      if (item) dispatch({ type: 'SET_PAGE', page: item.page });\n    } else if (page !== null) {\n      dispatch({ type: 'SET_PAGE', page: null });\n    }\n  };\n}\n\nexport function pointermove(event: MapBrowserEvent): void {\n  const { map } = event;\n  const pixel = map.getEventPixel(event.originalEvent);\n  const hit = map.hasFeatureAtPixel(pixel, { layerFilter: (layer) => layer instanceof VectorLayer, hitTolerance: 10 });\n  const target = map.getTarget();\n  if (target && typeof target !== 'string') target.style.cursor = hit ? 'pointer' : '';\n}\n","import { hasCoords } from './helpers';\nimport { FirstQueryResult, LangLink } from '../types';\nimport { Action } from './AppState';\n\nconst query = [\n  'api.php?',\n  'origin=*',\n  '&action=query',\n  '&prop=extracts|pageimages|coordinates|langlinks|description',\n  '&exintro&explaintext',\n  '&pithumbsize=200',\n  '&coprimary=all',\n  '&list=search',\n  '&format=json',\n  '&formatversion=2',\n  '&redirects',\n].join('');\n\nfunction createFirstURL(lang: string, title: string) {\n  return `https://${lang}.wikipedia.org/w/${query}&titles=${encodeURI(title)}&srsearch=${encodeURI(title)}`;\n}\n\nconst langOrder = ['en', 'es', 'de', 'zh', 'ar', 'kr', 'ja'];\n\nasync function fetchLangLinksCoordinates(langLinks?: LangLink[]) {\n  if (!langLinks || !langLinks.length) return null;\n  const tasks: Promise<FirstQueryResult>[] = langLinks\n    .filter(({ lang }) => langOrder.indexOf(lang) >= 0)\n    .map(({ lang, title }) => fetch(createFirstURL(lang, title)).then((res) => res.json()));\n\n  const coord = await Promise.all(tasks).then((data) => {\n    const hasCoordinates = data.map((result) => result.query.pages[0]).filter(hasCoords);\n    if (hasCoordinates.length) return hasCoordinates[0].coordinates;\n    return null;\n  });\n  return coord;\n}\n\nasync function fetchPages(title: string, dispatch: React.Dispatch<Action>): Promise<void> {\n  if (title === '') return;\n  dispatch({ type: 'FETCH', fetchStatus: 'fetching', fetchTitle: title });\n  dispatch({ type: 'CLEAR_SEARCHEDITEMS' });\n\n  try {\n    const result: FirstQueryResult = await fetch(createFirstURL('ja', title)).then((res) => res.json());\n    const page = result.query.pages[0];\n    const { search } = result.query;\n    if (page.missing || page.description === 'ウィキメディアの曖昧さ回避ページ' || page.description === '曖昧さ回避ページ') {\n      dispatch({ type: 'SET_PAGE', page: null });\n      dispatch({ type: 'SET_SEARCHEDITEMS', items: search });\n      dispatch({ type: 'FETCH', fetchStatus: 'success' });\n    } else {\n      dispatch({ type: 'SET_PAGE', page });\n      if (!page.coordinates) {\n        const coordinates = await fetchLangLinksCoordinates(page.langlinks);\n        dispatch({ type: 'FETCH', fetchStatus: 'success' });\n        if (coordinates) {\n          dispatch({ type: 'SET_PAGE', page: { ...page, coordinates } });\n        }\n      } else {\n        dispatch({ type: 'FETCH', fetchStatus: 'success' });\n      }\n    }\n  } catch (err) {\n    dispatch({ type: 'FETCH', fetchStatus: 'failure' });\n  }\n}\n\nexport default fetchPages;\n","import * as React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport InputBase from '@material-ui/core/InputBase';\nimport IconButton from '@material-ui/core/IconButton';\nimport Tooltip from '@material-ui/core/Tooltip';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport { useDispatch } from '../../utils/AppStateContext';\nimport fetchPages from '../../utils/fetchPages';\nimport { SearchIcon } from '../../icons';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      display: 'flex',\n      paddingLeft: 10,\n    },\n    input: {\n      flexGrow: 1,\n    },\n    iconButton: {\n      padding: 10,\n    },\n  })\n);\n\nfunction SearchForm(): JSX.Element {\n  const classes = useStyles();\n  const dispatch = useDispatch();\n  const [title, setTitle] = React.useState('');\n\n  const onChangeForm = (event: React.ChangeEvent<HTMLInputElement>) => {\n    event.preventDefault();\n    setTitle(event.currentTarget.value);\n  };\n  const onSubmit = () => {\n    fetchPages(title, dispatch);\n  };\n  const onKeyPress = (event: React.KeyboardEvent<HTMLInputElement>) => {\n    if (event.key === 'Enter' && title !== '') {\n      onSubmit();\n      if (document.activeElement instanceof HTMLElement) {\n        document.activeElement.blur();\n      }\n    }\n  };\n\n  return (\n    <Paper className={classes.root}>\n      <InputBase\n        className={classes.input}\n        placeholder=\"Search Wikipedia\"\n        inputProps={{ 'aria-label': 'search wikipedia' }}\n        value={title}\n        onChange={onChangeForm}\n        onKeyPress={onKeyPress}\n      />\n      <Tooltip title=\"検索\">\n        <IconButton type=\"submit\" className={classes.iconButton} aria-label=\"search\" onClick={onSubmit}>\n          <SearchIcon />\n        </IconButton>\n      </Tooltip>\n    </Paper>\n  );\n}\n\nexport default SearchForm;\n","import * as React from 'react';\nimport Snackbar from '@material-ui/core/Snackbar';\nimport Button from '@material-ui/core/Button';\n\ninterface Props {\n  message: string;\n  open: boolean;\n  onClose: (event: React.SyntheticEvent | React.MouseEvent, reason?: string) => void;\n}\n\nfunction MySnackbar({ message, open, onClose }: Props): JSX.Element {\n  return (\n    <Snackbar\n      anchorOrigin={{\n        vertical: 'bottom',\n        horizontal: 'center',\n      }}\n      open={open}\n      autoHideDuration={6000}\n      onClose={onClose}\n      message={message}\n      action={\n        <Button color=\"secondary\" size=\"small\" onClick={onClose}>\n          OK\n        </Button>\n      }\n    />\n  );\n}\n\nexport default MySnackbar;\n","import * as React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport Button from '@material-ui/core/Button';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport Snackbar from '../Snackbar';\nimport { useAppState, useDispatch } from '../../utils/AppStateContext';\nimport { hasCoords } from '../../utils/helpers';\nimport { AddToMapIcon } from '../../icons';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      padding: theme.spacing(2),\n    },\n  })\n);\n\nfunction SearchResult(): JSX.Element | null {\n  const classes = useStyles();\n  const { page, features, fetchTitle } = useAppState();\n  const dispatch = useDispatch();\n  const [snackbarOpen, setSnackbarOpen] = React.useState(false);\n  React.useEffect(() => {\n    setSnackbarOpen(false);\n  }, [page]);\n  const isExist = new Set(features.map((feature) => feature.page.pageid)).has(page?.pageid ?? 0);\n\n  const onAddButtonClick = () => {\n    if (isExist) return;\n    if (page && fetchTitle && hasCoords(page)) {\n      dispatch({\n        type: 'ADD_FEATURE',\n        feature: {\n          page,\n          title: fetchTitle,\n        },\n      });\n      setSnackbarOpen(true);\n    }\n  };\n  const onClose = () => {\n    dispatch({ type: 'SET_PAGE', page: null });\n  };\n  const handleSnackbarClose = (event: React.SyntheticEvent | React.MouseEvent, reason?: string) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n    setSnackbarOpen(false);\n  };\n\n  return page ? (\n    <div className={classes.root}>\n      <Typography variant=\"h6\" gutterBottom>\n        {page.title}\n      </Typography>\n      <Typography variant=\"body2\" paragraph>\n        {page.extract.length > 140 ? `${page.extract.slice(0, 140)}...` : page.extract}\n      </Typography>\n      <div>\n        <Button\n          variant=\"contained\"\n          color={!isExist && page.coordinates ? 'primary' : 'default'}\n          disabled={!page.coordinates || isExist}\n          startIcon={<AddToMapIcon />}\n          onClick={onAddButtonClick}\n        >\n          地図に追加\n        </Button>{' '}\n        <Button variant=\"contained\" color=\"default\" disableElevation onClick={onClose}>\n          閉じる\n        </Button>\n      </div>\n      <Snackbar message={`${page.title}を追加しました`} open={snackbarOpen} onClose={handleSnackbarClose} />\n    </div>\n  ) : null;\n}\n\nexport default SearchResult;\n","import * as React from 'react';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { useAppState, useDispatch } from '../../utils/AppStateContext';\nimport fetchPages from '../../utils/fetchPages';\nimport { Search } from '../../types';\n\nfunction SearchedItems(): JSX.Element | null {\n  const { searchedItems } = useAppState();\n  const dispatch = useDispatch();\n  const onClick = (searchItem: Search) => () => {\n    fetchPages(searchItem.title, dispatch);\n  };\n  return searchedItems.length ? (\n    <List subheader={<ListSubheader>検索結果</ListSubheader>}>\n      {searchedItems.map((item) => (\n        <ListItem key={item.title} button dense onClick={onClick(item)}>\n          <ListItemText primary={item.title} />\n        </ListItem>\n      ))}\n    </List>\n  ) : null;\n}\n\nexport default SearchedItems;\n","import * as React from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport SearchForm from '../components/Search/SearchForm';\nimport SearchResult from '../components/Search/SearchResult';\nimport SearchedItems from '../components/Search/SearchedItems';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    searchBox: {\n      padding: theme.spacing(2, 1),\n    },\n  })\n);\n\nfunction DrawerSearch(): JSX.Element {\n  const classes = useStyles();\n  return (\n    <div>\n      <div className={classes.searchBox}>\n        <SearchForm />\n      </div>\n      <SearchResult />\n      <SearchedItems />\n    </div>\n  );\n}\n\nexport default DrawerSearch;\n","import * as React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Dialog, { DialogProps } from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogContentText from '@material-ui/core/DialogContentText';\n\ntype Props = {\n  variant?: 'text' | 'content';\n  text?: string;\n  content?: React.ReactNode;\n  actionButton: React.ReactNode;\n  dialogHandler: (open: boolean) => () => void;\n} & DialogProps;\n\nfunction MyDialog({ variant, text, content, open, fullWidth, maxWidth, actionButton, dialogHandler }: Props): JSX.Element {\n  return (\n    <Dialog\n      fullWidth={fullWidth}\n      maxWidth={maxWidth}\n      open={open}\n      onClose={dialogHandler(false)}\n      aria-labelledby=\"dialog-title\"\n      aria-describedby=\"dialog-description\"\n    >\n      <DialogContent>{variant === 'text' ? <DialogContentText>{text}</DialogContentText> : content}</DialogContent>\n      <DialogActions>\n        <Button onClick={dialogHandler(false)} color=\"primary\">\n          閉じる\n        </Button>\n        {actionButton}\n      </DialogActions>\n    </Dialog>\n  );\n}\n\nMyDialog.defaultProps = {\n  variant: 'text',\n  text: undefined,\n  content: undefined,\n};\n\nexport default MyDialog;\n","import * as React from 'react';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport IconButton from '@material-ui/core/IconButton';\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Button from '@material-ui/core/Button';\nimport MoreVertIcon from '@material-ui/icons/MoreVert';\nimport PinDropIcon from '@material-ui/icons/PinDrop';\nimport DeleteIcon from '@material-ui/icons/Delete';\nimport { fromLonLat } from 'ol/proj';\nimport Snackbar from './Snackbar';\nimport Dialog from './Dialog';\nimport { useAppState, useDispatch } from '../utils/AppStateContext';\nimport { useMap } from '../utils/MapContext';\nimport { PageFeature } from '../types';\nimport { MapIcon, ReadIcon } from '../icons';\n\nfunction FeaturesList(): JSX.Element {\n  const [anchorEl, setAnchorEl] = React.useState<null | HTMLElement>(null);\n  const [selectedFeature, setSelectedFeature] = React.useState<null | PageFeature>(null);\n  const [snackbarOpen, setSnackbarOpen] = React.useState(false);\n  const [snackbarMessage, setSnackbarMessage] = React.useState('');\n  const [DialogOpen, setDialogOpen] = React.useState(false);\n  const menuOpen = Boolean(anchorEl);\n  const { features, page } = useAppState();\n  const dispatch = useDispatch();\n  const { pathname } = useLocation();\n  const history = useHistory();\n  const map = useMap();\n\n  const handleClick = (feature: PageFeature) => (event: React.MouseEvent<HTMLElement>) => {\n    setAnchorEl(event.currentTarget);\n    setSelectedFeature(feature);\n  };\n  const handleClose = () => {\n    setAnchorEl(null);\n    setSelectedFeature(null);\n  };\n  const handleDialogOpen = (open: boolean) => () => {\n    setDialogOpen(open);\n  };\n  const onClick = (feature: PageFeature) => () => {\n    dispatch({ type: 'SET_PAGE', page: feature.page });\n  };\n  const focusFeature = () => {\n    const coordinates = selectedFeature?.page?.coordinates;\n    if (coordinates) {\n      const coord = coordinates[0];\n      map.getView().animate({\n        center: fromLonLat([coord.lon, coord.lat]),\n        duration: 500,\n      });\n      handleClose();\n      if (pathname !== '/') {\n        history.push('/');\n      }\n    }\n  };\n  const readPage = () => {\n    if (selectedFeature) {\n      dispatch({ type: 'SET_PAGE', page: selectedFeature.page });\n      handleClose();\n      history.push('/article');\n    }\n  };\n  const deleteFeature = () => {\n    if (selectedFeature) {\n      dispatch({ type: 'DELETE_FEATURE', feature: selectedFeature });\n      setSnackbarMessage(`${selectedFeature?.title}を削除しました`);\n      setSnackbarOpen(true);\n      handleClose();\n    }\n  };\n  const DialogAction = () => {\n    dispatch({ type: 'CLEAR_FEATURES' });\n    setDialogOpen(false);\n    setSnackbarMessage('アイテムを全てを削除しました');\n    setSnackbarOpen(true);\n  };\n  const handleSnackbarClose = (event: React.SyntheticEvent | React.MouseEvent, reason?: string) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n    setSnackbarOpen(false);\n  };\n\n  return (\n    <List subheader={<ListSubheader>アイテム</ListSubheader>}>\n      {features.length ? (\n        <ListItem button dense onClick={handleDialogOpen(true)}>\n          <ListItemText primary=\"全て消去\" />\n        </ListItem>\n      ) : null}\n      {features.map((feature) => (\n        <ListItem key={feature.title} button onClick={onClick(feature)}>\n          <ListItemIcon>\n            <MapIcon color={feature.page.title === page?.title ? 'error' : 'primary'} />\n          </ListItemIcon>\n          <ListItemText primary={feature.title} />\n          <ListItemSecondaryAction>\n            <IconButton edge=\"end\" onClick={handleClick(feature)}>\n              <MoreVertIcon />\n            </IconButton>\n          </ListItemSecondaryAction>\n        </ListItem>\n      ))}\n      <Menu anchorEl={anchorEl} open={menuOpen} onClose={handleClose}>\n        <MenuItem onClick={focusFeature}>\n          <ListItemIcon>\n            <PinDropIcon />\n          </ListItemIcon>\n          地図で見る\n        </MenuItem>\n        <MenuItem onClick={readPage}>\n          <ListItemIcon>\n            <ReadIcon />\n          </ListItemIcon>\n          記事を読む\n        </MenuItem>\n        <MenuItem onClick={deleteFeature}>\n          <ListItemIcon>\n            <DeleteIcon />\n          </ListItemIcon>\n          削除\n        </MenuItem>\n      </Menu>\n      <Snackbar message={snackbarMessage} open={snackbarOpen} onClose={handleSnackbarClose} />\n      <Dialog\n        text=\"現在のアイテムを全て消去しますか？\"\n        open={DialogOpen}\n        dialogHandler={handleDialogOpen}\n        onClose={handleDialogOpen(false)}\n        actionButton={\n          <Button variant=\"contained\" color=\"primary\" onClick={DialogAction}>\n            実行\n          </Button>\n        }\n      />\n    </List>\n  );\n}\n\nexport default FeaturesList;\n","import * as React from 'react';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Switch from '@material-ui/core/Switch';\nimport { useAppState, useDispatch } from '../utils/AppStateContext';\nimport { GeolocationOnIcon, GeolocationOffIcon, ShowLabelsIcon } from '../icons';\n\nfunction AppStateHandler(): JSX.Element {\n  const { geolocation, alwaysShowLabels } = useAppState();\n  const dispatch = useDispatch();\n  const toggleGeoLocation = () => {\n    dispatch({ type: 'TOGGLE_GEOLOCATION' });\n  };\n  const toggleAlwaysShowLabels = () => {\n    dispatch({ type: 'TOGGLE_ALWAYSSHOWLABELS' });\n  };\n  return (\n    <List subheader={<ListSubheader>App State</ListSubheader>}>\n      <ListItem>\n        <ListItemIcon>{geolocation ? <GeolocationOnIcon /> : <GeolocationOffIcon />}</ListItemIcon>\n        <ListItemText primary=\"現在地を表示\" />\n        <ListItemSecondaryAction>\n          <Switch edge=\"end\" checked={geolocation} onChange={toggleGeoLocation} />\n        </ListItemSecondaryAction>\n      </ListItem>\n      <ListItem>\n        <ListItemIcon>\n          <ShowLabelsIcon />\n        </ListItemIcon>\n        <ListItemText primary=\"ラベルを常に表示\" />\n        <ListItemSecondaryAction>\n          <Switch edge=\"end\" checked={alwaysShowLabels} onChange={toggleAlwaysShowLabels} />\n        </ListItemSecondaryAction>\n      </ListItem>\n    </List>\n  );\n}\n\nexport default AppStateHandler;\n","import * as React from 'react';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport { useAppState, useDispatch } from '../utils/AppStateContext';\nimport { baseLayers, BaseLayer } from '../layers/baseLayers';\nimport { LayersIcon } from '../icons';\n\nfunction MapStateHandler(): JSX.Element {\n  const { baseLayer } = useAppState();\n  const dispatch = useDispatch();\n  const onClick = (id: BaseLayer) => () => {\n    dispatch({ type: 'SET_BASELAYER', layer: id });\n  };\n\n  return (\n    <List subheader={<ListSubheader>背景地図</ListSubheader>}>\n      {baseLayers.map(({ id, title }) => (\n        <ListItem key={id} button onClick={onClick(id)}>\n          <ListItemIcon>\n            <LayersIcon color={id === baseLayer ? 'primary' : 'disabled'} />\n          </ListItemIcon>\n          <ListItemText primary={title} />\n        </ListItem>\n      ))}\n    </List>\n  );\n}\n\nexport default MapStateHandler;\n","import * as React from 'react';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport Switch from '@material-ui/core/Switch';\nimport { useTheme } from '@material-ui/core/styles';\nimport { useToggleDarkMode } from '../utils/DispatchContext';\nimport { LightModeIcon, DarkModeIcon } from '../icons';\n\nfunction ThemeStateHandler(): JSX.Element {\n  const { palette } = useTheme();\n  const toggleDarkMode = useToggleDarkMode();\n  return (\n    <List subheader={<ListSubheader>Theme State</ListSubheader>}>\n      <ListItem>\n        <ListItemIcon>{palette.type === 'dark' ? <DarkModeIcon /> : <LightModeIcon />}</ListItemIcon>\n        <ListItemText primary=\"ダークモード\" />\n        <ListItemSecondaryAction>\n          <Switch edge=\"end\" checked={palette.type === 'dark'} onChange={toggleDarkMode} />\n        </ListItemSecondaryAction>\n      </ListItem>\n    </List>\n  );\n}\n\nexport default ThemeStateHandler;\n","import * as React from 'react';\nimport { FeatureCollection } from 'geojson';\nimport { PageFeature } from '../types';\nimport { useAppState } from './AppStateContext';\nimport { getCoordinate } from './helpers';\n\nexport function featuresToGeoJSON(features: PageFeature[]): FeatureCollection {\n  return {\n    type: 'FeatureCollection',\n    features: features.map((feature) => {\n      const { title, page } = feature;\n      const coordinates = getCoordinate(page);\n\n      return {\n        type: 'Feature',\n        geometry: {\n          type: 'Point',\n          coordinates,\n        },\n        properties: {\n          name: title,\n          pageTitle: page.title,\n          url: `https://ja.wikipedia.org/wiki/${page.title}`,\n        },\n      };\n    }),\n  };\n}\n\nexport function exportFile(geojson: FeatureCollection): string {\n  const blob = new Blob([JSON.stringify(geojson, null, 2)], { type: 'application/json' });\n  const url = URL.createObjectURL(blob);\n  return url;\n}\n\nexport function useGeoJSON(): string {\n  const { features } = useAppState();\n  return React.useMemo(() => JSON.stringify(featuresToGeoJSON(features), null, 2), [features]);\n}\n\nexport function useBlobUrl(json: string): string {\n  return React.useMemo(() => {\n    const blob = new Blob([json], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    return url;\n  }, [json]);\n}\n","import * as React from 'react';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Button from '@material-ui/core/Button';\nimport TextField from '@material-ui/core/TextField';\nimport GetAppIcon from '@material-ui/icons/GetApp';\nimport RestoreIcon from '@material-ui/icons/Restore';\nimport Snackbar from './Snackbar';\nimport Dialog from './Dialog';\nimport { useGeoJSON, useBlobUrl } from '../utils/exportGeoJSON';\nimport { useDispatch } from '../utils/AppStateContext';\n\nfunction StateActions(): JSX.Element {\n  const [actionType, setActionType] = React.useState<'reset' | 'download'>('reset');\n  const [snackbarOpen, setSnackbarOpen] = React.useState(false);\n  const [snackbarMessage, setSnackbarMessage] = React.useState('');\n  const [modalOpen, setModalOpen] = React.useState(false);\n  const dispatch = useDispatch();\n  const geojson = useGeoJSON();\n  const downloadUrl = useBlobUrl(geojson);\n\n  const handleModalOpen = (open: boolean) => () => {\n    setModalOpen(open);\n  };\n  const modalAction = () => {\n    if (actionType === 'reset') {\n      dispatch({ type: 'RESET' });\n      window.localStorage.removeItem('wikilayers:AppState');\n      window.localStorage.removeItem('wikilayers:ThemeState');\n      setSnackbarMessage('設定を初期化しました');\n      setSnackbarOpen(true);\n    }\n    setModalOpen(false);\n  };\n  const handleSnackbarClose = (event: React.SyntheticEvent | React.MouseEvent, reason?: string) => {\n    if (reason === 'clickaway') {\n      return;\n    }\n    setSnackbarOpen(false);\n  };\n  const resetClicked = () => {\n    setActionType('reset');\n    setModalOpen(true);\n  };\n  const downloadClicked = () => {\n    setActionType('download');\n    setModalOpen(true);\n  };\n  const dialog = (\n    <Dialog\n      variant={actionType === 'reset' ? 'text' : 'content'}\n      open={modalOpen}\n      fullWidth={actionType === 'download'}\n      maxWidth={actionType === 'download' ? 'sm' : undefined}\n      dialogHandler={handleModalOpen}\n      onClose={handleModalOpen(false)}\n      text={actionType === 'reset' ? '設定を初期化しますか？' : undefined}\n      content={\n        actionType === 'download' ? (\n          <TextField multiline fullWidth rowsMax={20} label=\"GeoJSON\" variant=\"outlined\" value={geojson} />\n        ) : undefined\n      }\n      actionButton={\n        actionType === 'reset' ? (\n          <Button variant=\"contained\" color=\"primary\" onClick={modalAction}>\n            実行\n          </Button>\n        ) : (\n          <Button\n            component=\"a\"\n            variant=\"contained\"\n            color=\"primary\"\n            onClick={modalAction}\n            startIcon={<GetAppIcon />}\n            download\n            href={downloadUrl}\n          >\n            ダウンロード\n          </Button>\n        )\n      }\n    />\n  );\n\n  return (\n    <List subheader={<ListSubheader>機能</ListSubheader>}>\n      <ListItem button onClick={downloadClicked}>\n        <ListItemIcon>\n          <GetAppIcon />\n        </ListItemIcon>\n        <ListItemText>GeoJSON 形式で出力</ListItemText>\n      </ListItem>\n      <ListItem button onClick={resetClicked}>\n        <ListItemIcon>\n          <RestoreIcon />\n        </ListItemIcon>\n        <ListItemText>設定を初期化する</ListItemText>\n      </ListItem>\n      <Snackbar message={snackbarMessage} open={snackbarOpen} onClose={handleSnackbarClose} />\n      {dialog}\n    </List>\n  );\n}\n\nexport default StateActions;\n","import * as React from 'react';\nimport { Link } from 'react-router-dom';\nimport List from '@material-ui/core/List';\nimport ListSubheader from '@material-ui/core/ListSubheader';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport InfoIcon from '@material-ui/icons/Info';\n\nfunction Credit(): JSX.Element {\n  return (\n    <List subheader={<ListSubheader>WikiLayers</ListSubheader>}>\n      <ListItem button component={Link} to=\"/about\">\n        <ListItemIcon>\n          <InfoIcon />\n        </ListItemIcon>\n        <ListItemText primary=\"WikiLayersについて\" />\n      </ListItem>\n    </List>\n  );\n}\n\nexport default Credit;\n","import * as React from 'react';\nimport Box from '@material-ui/core/Box';\nimport DrawerSearch from './DrawerSearch';\nimport WikiLayersTitle from '../components/WikiLayersTitle';\nimport FeaturesList from '../components/FeaturesList';\nimport AppStateHandler from '../components/AppStateHandler';\nimport MapStateHandler from '../components/MapStateHandler';\nimport ThemeStateHandler from '../components/ThemeStateHandler';\nimport StateActions from '../components/StateActions';\nimport Credit from '../components/Credit';\n\nfunction AppDrawer(): JSX.Element {\n  return (\n    <div>\n      <Box py={4}>\n        <WikiLayersTitle variant=\"h4\" />\n      </Box>\n      <DrawerSearch />\n      <FeaturesList />\n      <MapStateHandler />\n      <AppStateHandler />\n      <ThemeStateHandler />\n      <StateActions />\n      <Credit />\n    </div>\n  );\n}\n\nexport default AppDrawer;\n","import * as React from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport BottomNavigation from '@material-ui/core/BottomNavigation';\nimport BottomNavigationAction from '@material-ui/core/BottomNavigationAction';\nimport { useTheme } from '@material-ui/core/styles';\nimport useMediaQuery from '@material-ui/core/useMediaQuery';\nimport { MapIcon, SearchIcon, ReadIcon, SettingsIcon } from '../icons';\n// import { useIsMobile } from '../utils/useIsMobile';\n\nfunction pathnameToValue(pathname: string) {\n  if (pathname === '/') return 'map';\n  if (pathname === '/search') return 'search';\n  if (pathname === '/article') return 'article';\n  if (pathname === '/settings') return 'settings';\n  return null;\n}\n\nfunction BottomNav(): JSX.Element {\n  const { pathname } = useLocation();\n  const theme = useTheme();\n  const isMobile = useMediaQuery(theme.breakpoints.down('sm'));\n  // const isMobile = useIsMobile();\n\n  return (\n    <BottomNavigation value={pathnameToValue(pathname)} showLabels>\n      <BottomNavigationAction component={Link} to=\"/\" value=\"map\" label=\"地図\" icon={<MapIcon />} />\n      {isMobile ? <BottomNavigationAction component={Link} to=\"/search\" value=\"search\" label=\"探す\" icon={<SearchIcon />} /> : null}\n      <BottomNavigationAction component={Link} to=\"/article\" value=\"article\" label=\"読む\" icon={<ReadIcon />} />\n      {isMobile ? <BottomNavigationAction component={Link} to=\"/settings\" value=\"settings\" label=\"設定\" icon={<SettingsIcon />} /> : null}\n    </BottomNavigation>\n  );\n}\n\nexport default BottomNav;\n","import * as React from 'react';\nimport Drawer from '@material-ui/core/Drawer';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport Hidden from '@material-ui/core/Hidden';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport DrawerInner from './Drawer';\nimport BottomNav from './BottomNav';\nimport { useAppState } from '../utils/AppStateContext';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexGrow: 1,\n    },\n    progress: {\n      position: 'fixed',\n      top: 0,\n      left: 0,\n      width: '100%',\n    },\n    drawer: {\n      [theme.breakpoints.up('md')]: {\n        width: 280,\n        flexShrink: 0,\n      },\n    },\n    drawerPaper: {\n      width: 280,\n      paddingBottom: 56,\n    },\n    content: {\n      display: 'flex',\n      flexDirection: 'column',\n      flexGrow: 1,\n      paddingBottom: 56,\n      transition: theme.transitions.create('width'),\n    },\n    bottomNav: {\n      position: 'fixed',\n      bottom: 0,\n      right: 0,\n      width: '100%',\n      boxShadow: theme.shadows[2],\n      zIndex: theme.zIndex.appBar,\n      [theme.breakpoints.up('md')]: {\n        width: `calc(100% - ${280}px)`,\n      },\n    },\n  })\n);\n\ninterface Props {\n  children: React.ReactNode;\n}\n\nfunction Layout({ children }: Props): JSX.Element {\n  const { fetchStatus } = useAppState();\n  const classes = useStyles();\n  return (\n    <div className={classes.root}>\n      <Hidden smDown implementation=\"css\">\n        <nav className={classes.drawer}>\n          <Drawer\n            classes={{\n              paper: classes.drawerPaper,\n            }}\n            variant=\"permanent\"\n            open\n          >\n            <DrawerInner />\n          </Drawer>\n        </nav>\n      </Hidden>\n      <div className={classes.content}>\n        {children}\n        <div className={classes.bottomNav}>\n          <BottomNav />\n        </div>\n      </div>\n      <div className={classes.progress}>{fetchStatus === 'fetching' ? <LinearProgress color=\"secondary\" /> : null}</div>\n    </div>\n  );\n}\n\nexport default Layout;\n","import * as React from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport { useMap } from '../../utils/MapContext';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    mapContainer: {\n      display: 'flex',\n      flexGrow: 1,\n    },\n    map: {\n      display: 'flex',\n      flexGrow: 1,\n    },\n    multiply: {\n      mixBlendMode: 'multiply',\n    },\n  })\n);\n\nfunction MapApp(): JSX.Element {\n  const classes = useStyles();\n  const map = useMap();\n  const mapRef = React.useRef(null);\n\n  React.useEffect(() => {\n    map.setTarget(document.getElementById('map') ?? undefined);\n    return () => map.setTarget(undefined);\n  });\n\n  /*\n  const appState = useAppState();\n  const dispatch = useDispatch();\n  const { palette } = useTheme();\n  const mapRef = React.useRef(null);\n\n  const vectorLayer = new VectorLayer({\n    source: new VectorSource({\n      attributions: ['<a href=\"https://ja.wikipedia.org\" target=\"_blank\">Wikipedia</a>'],\n    }),\n    style: vectorStyle,\n  });\n\n  const map = new OlMap({\n    layers: [baseLayerGroup, vectorLayer],\n    controls: defaultControl({\n      attribution: false,\n    }).extend([\n      new Attribution({\n        collapsible: false,\n      }),\n    ]),\n  });\n\n  const geolocation = new Geolocation({\n    tracking: false,\n    projection: map.getView().getProjection(),\n  });\n\n  React.useEffect(() => {\n    const view = JSON.parse(window.localStorage.getItem('wikilayers:view'));\n\n    map.setView(\n      new View({\n        zoom: view?.zoom ?? 6,\n        center: view?.center ?? fromLonLat([140.4, 36.4]),\n        constrainRotation: 4,\n      })\n    );\n\n    setGeolocation(map, geolocation);\n    createVectorEvent(map, appState, dispatch);\n\n    vectorLayer.getSource().addFeatures(appState.features.map((feature) => pageToFeature(feature)));\n\n    vtLayer.setStyle(vtStyle(palette.type));\n    setVisibleBaseLayer(appState.baseLayer);\n\n    map.setTarget(document.getElementById('map'));\n\n    return () => map.setTarget(null);\n  });\n\n  React.useEffect(() => {\n    vectorLayer.getSource().forEachFeature((feature) => {\n      feature.setProperties({\n        selected: feature.get('pageTitle') === appState.page?.title,\n      });\n    });\n  }, [appState.page]);\n\n  React.useEffect(() => {\n    vectorLayer.getSource().clear();\n    vectorLayer.getSource().addFeatures(appState.features.map((feature) => pageToFeature(feature)));\n  }, [appState.features]);\n\n  React.useEffect(() => {\n    geolocation.setTracking(appState.geolocation);\n  }, [appState.geolocation]);\n\n  React.useEffect(() => {\n    vtLayer.setStyle(vtStyle(palette.type));\n  }, [palette.type]);\n\n  React.useEffect(() => {\n    setVisibleBaseLayer(appState.baseLayer);\n  }, [appState.baseLayer]);\n\n  map.on('moveend', (event) => {\n    const view = event.map.getView();\n    window.localStorage.setItem('wikilayers:view', JSON.stringify({ zoom: view.getZoom(), center: view.getCenter() }));\n  });\n  */\n  /*\n  componentDidUpdate() {\n    this.createMap();\n    // TODO: this.updateMap();\n    this.vector.getSource().forEachFeature((olFeature) => {\n      olFeature.setProperties({\n        selected: olFeature.getId() === this.props.selectedFeature.id,\n      });\n    });\n  }\n\n  componentWillUnmount() {\n    if (this.map) {\n      this.props.updateMapView(this.map.getView().getProperties());\n\n      this.props.saveGeolocation({\n        tracking: this.geolocation.getTracking(),\n        cachedPosition:\n          this.geolocation.getPosition() ||\n          this.geolocation.get(\"cachedPosition\"),\n      });\n    }\n  }\n\n  const _createMap = () => {\n    if (this.map) return;\n\n    const vectorLayer = new VectorLayer({\n      source: new VectorSource({\n        features: props.features.map((feature) =>\n          createOlFeature(feature)\n        ),\n        attributions: [\n          '<a href=\"https://ja.wikipedia.org\" target=\"_blank\">Wikipedia</a>',\n        ],\n      }),\n      style: props.mapConfigure.showLabels ? allLabelStyle : vectorStyle,\n      title: \"features\",\n    });\n\n    const baseLayers = initialBaseLayers();\n    baseLayers.forEach((layer) => {\n      layer.setVisible(layer.get(\"title\") === props.visibleBaseLayer);\n    });\n\n    this.map = new OlMap({\n      view: new View(this.props.mapView),\n      layers: [\n        new Group({\n          layers: baseLayers,\n        }),\n        this.vector,\n      ],\n      controls: customControl,\n      target: \"map\",\n    });\n    \n    this.map.on('moveend', () => {\n      this.props.updateMapView(this.map.getView().getProperties());\n    });\n\n    createVectorEvent(this.map, {\n      selectFeature: this.props.selectFeature,\n      clearSelectedFeature: this.props.clearSelectedFeature,\n    });\n\n    this.geolocation = new Geolocation({\n      tracking: this.props.mapConfigure.geolocation.tracking,\n      projection: this.map.getView().getProjection(),\n    });\n\n    this.geolocation.setProperties({\n      cachedPosition: this.props.mapConfigure.geolocation.cachedPosition,\n    });\n\n    if (this.props.mapConfigure.geolocation.tracking) {\n      setGeolocation(this.map, this.geolocation);\n    }\n  }\n*/\n  return (\n    <div className={classes.mapContainer} ref={mapRef}>\n      <div className={classes.map} id=\"map\" />\n    </div>\n  );\n}\n\nexport default MapApp;\n","import * as React from 'react';\nimport { Link } from 'react-router-dom';\nimport Paper from '@material-ui/core/Paper';\nimport Typography from '@material-ui/core/Typography';\nimport Accodrdion from '@material-ui/core/Accordion';\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\nimport AccordionActions from '@material-ui/core/AccordionActions';\nimport Button from '@material-ui/core/Button';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { useAppState } from '../../utils/AppStateContext';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    card: {\n      maxWidth: 280,\n    },\n  })\n);\n\nfunction MapInfo(): JSX.Element | null {\n  const classes = useStyles();\n  const { page } = useAppState();\n\n  return page ? (\n    <Paper className={classes.card}>\n      <Accodrdion>\n        <AccordionSummary expandIcon={<ExpandMoreIcon />} aria-controls=\"mapinfo\" id=\"mapinfo-header\">\n          <Typography>{page.title}</Typography>\n        </AccordionSummary>\n        <AccordionDetails>\n          <Typography variant=\"body2\">{page.extract.length > 140 ? `${page.extract.slice(0, 140)}...` : page.extract}</Typography>\n        </AccordionDetails>\n        <AccordionActions>\n          <Button variant=\"contained\" color=\"primary\" component={Link} to=\"/article\">\n            記事を読む\n          </Button>\n        </AccordionActions>\n      </Accodrdion>\n    </Paper>\n  ) : null;\n}\n\nexport default MapInfo;\n","import * as React from 'react';\nimport ReactGA from 'react-ga';\n\nReactGA.initialize('UA-74683419-4');\n\nfunction useGaTrackPage(path: string): void {\n  React.useEffect(() => {\n    ReactGA.pageview(path);\n  }, [path]);\n}\n\nexport default useGaTrackPage;\n","import * as React from 'react';\nimport { useLocation } from 'react-router-dom';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport MapApp from './MapApp';\nimport MapInfo from './MapInfo';\nimport useGaTrackPage from '../../utils/useGaTrackPage';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexGrow: 1,\n    },\n    info: {\n      position: 'fixed',\n      top: theme.spacing(1),\n      right: theme.spacing(1),\n    },\n  })\n);\n\nfunction MapPage(): JSX.Element {\n  const classes = useStyles();\n  const { pathname } = useLocation();\n  useGaTrackPage(pathname);\n  return (\n    <div className={classes.root}>\n      <MapApp />\n      <div className={classes.info}>\n        <MapInfo />\n      </div>\n    </div>\n  );\n}\n\nexport default MapPage;\n","import * as React from 'react';\nimport Container, { ContainerProps } from '@material-ui/core/Container';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      flexGrow: 1,\n      paddingTop: theme.spacing(2),\n    },\n  })\n);\n\ninterface Props {\n  children: ContainerProps['children'];\n}\n\nfunction PageContainer({ children }: Props): JSX.Element {\n  const classes = useStyles();\n  return (\n    <div className={classes.root}>\n      <Container maxWidth=\"sm\" disableGutters>\n        {children}\n      </Container>\n    </div>\n  );\n}\n\nexport default PageContainer;\n","import * as React from 'react';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport WikiLayersTitle from '../WikiLayersTitle';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    root: {\n      padding: theme.spacing(6, 0),\n    },\n  })\n);\n\nfunction Title(): JSX.Element {\n  const classes = useStyles();\n  return (\n    <div className={classes.root}>\n      <WikiLayersTitle variant=\"h2\" />\n    </div>\n  );\n}\n\nexport default Title;\n","import * as React from 'react';\nimport { useLocation } from 'react-router-dom';\nimport Container from '@material-ui/core/Container';\nimport PageContainer from '../../components/PageContainer';\nimport Title from '../../components/Search/Title';\nimport SearchForm from '../../components/Search/SearchForm';\nimport SearchResult from '../../components/Search/SearchResult';\nimport SearchedItems from '../../components/Search/SearchedItems';\nimport FeaturesList from '../../components/FeaturesList';\nimport useGaTrackPage from '../../utils/useGaTrackPage';\n\nfunction SearchPage(): JSX.Element {\n  const { pathname } = useLocation();\n  useGaTrackPage(pathname);\n\n  return (\n    <PageContainer>\n      <Title />\n      <Container>\n        <SearchForm />\n      </Container>\n      <SearchResult />\n      <SearchedItems />\n      <FeaturesList />\n    </PageContainer>\n  );\n}\n\nexport default SearchPage;\n","import * as React from 'react';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    root: {\n      display: 'flex',\n      flexGrow: 1,\n      alignItems: 'center',\n      justifyContent: 'center',\n    },\n  })\n);\n\nfunction Loader(): JSX.Element {\n  const classes = useStyles();\n  return (\n    <div className={classes.root}>\n      <CircularProgress />\n    </div>\n  );\n}\n\nexport default Loader;\n","import { Article } from '../types';\n\ntype Cache = {\n  [key: string]: Article;\n};\n\nclass ArticleCache {\n  cache: Cache;\n\n  constructor() {\n    const storaged = window.sessionStorage.getItem('wikilayers:article');\n    if (storaged) {\n      this.cache = JSON.parse(storaged);\n    } else {\n      this.cache = {};\n    }\n  }\n\n  articleExists(pageid: number | null): boolean {\n    if (!pageid) return false;\n    return Boolean(this.cache[pageid.toString()]);\n  }\n\n  setArticle(article: Article): ArticleCache {\n    const { pageid } = article;\n    this.cache[pageid.toString()] = article;\n    this.updateSessionStorage();\n    return this;\n  }\n\n  getArticle(pageid: number | null): Article | null {\n    if (!pageid) return null;\n    return this.cache[pageid.toString()];\n  }\n\n  updateSessionStorage(): void {\n    window.sessionStorage.setItem('wikilayers:article', JSON.stringify(this.cache));\n  }\n}\n\nexport default ArticleCache;\n","import * as React from 'react';\nimport { QueryPage, Article } from '../types';\nimport { Action } from './AppState';\nimport ArticleCache from './ArticleCache';\n\ntype ArticleStatus = 'exists' | 'yet' | 'failure';\n\nconst query = ['api.php?', 'origin=*', '&action=query', '&prop=extracts', '&format=json', '&formatversion=2', '&redirects'].join('');\n\nfunction createArticleUrl(pageid: number, lang = 'ja') {\n  return `https://${lang}.wikipedia.org/w/${query}&pageids=${pageid}`;\n}\n\nexport function useArticle(page: QueryPage | null, cache: ArticleCache): Article | null {\n  const exists = cache.articleExists(page?.pageid ?? null);\n  const [articleStatus, setArticleStatus] = React.useState<ArticleStatus>(exists ? 'exists' : 'yet');\n\n  React.useEffect(() => {\n    const nextExists = cache.articleExists(page?.pageid ?? null);\n    setArticleStatus(nextExists ? 'exists' : 'yet');\n  }, [page, cache]);\n\n  if (!page) return null;\n  if (page && articleStatus === 'exists') return cache.getArticle(page.pageid);\n\n  if (articleStatus === 'yet') {\n    fetch(createArticleUrl(page?.pageid))\n      .then((res) => res.json())\n      .then((json) => json.query.pages[0])\n      .then((article: Article) => {\n        cache.setArticle(article);\n        setArticleStatus('exists');\n      })\n      .catch(() => {\n        setArticleStatus('failure');\n      });\n  }\n\n  return null;\n}\n\nexport async function fetchArticle({ pageid }: QueryPage, cache: ArticleCache, dispatch: React.Dispatch<Action>): Promise<Article | null> {\n  if (cache.articleExists(pageid)) return cache.getArticle(pageid);\n\n  dispatch({ type: 'FETCH', fetchStatus: 'fetching' });\n\n  return fetch(createArticleUrl(pageid))\n    .then((res) => res.json())\n    .then((json) => json.query.pages[0]);\n}\n","import * as React from 'react';\nimport { useLocation } from 'react-router-dom';\nimport Container from '@material-ui/core/Container';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles, createStyles } from '@material-ui/core/styles';\nimport PageContainer from '../../components/PageContainer';\nimport Loader from '../../components/Loader';\nimport ArticleCache from '../../utils/ArticleCache';\nimport { useArticle } from '../../utils/fetchArticle';\nimport { useAppState } from '../../utils/AppStateContext';\nimport useGaTrackPage from '../../utils/useGaTrackPage';\n\nconst useStyles = makeStyles((theme) =>\n  createStyles({\n    article: {\n      padding: theme.spacing(2, 0),\n    },\n    title: {\n      padding: theme.spacing(2, 0),\n    },\n    loaderContainer: {\n      height: 400,\n      padding: theme.spacing(2, 0),\n    },\n  })\n);\n\nconst cache = new ArticleCache();\n\nfunction Article(): JSX.Element {\n  const classes = useStyles();\n  const { page } = useAppState();\n  const article = useArticle(page, cache);\n  const { pathname } = useLocation();\n  useGaTrackPage(pathname);\n\n  return (\n    <PageContainer>\n      <Container>\n        <div className={classes.article}>\n          {page ? (\n            <article>\n              <Typography className={classes.title} variant=\"h5\" component=\"h2\" gutterBottom>\n                {page?.title}\n              </Typography>\n              {article ? (\n                // eslint-disable-next-line\n                <div dangerouslySetInnerHTML={{ __html: article.extract }} />\n              ) : (\n                <>\n                  <Typography variant=\"body2\" paragraph>\n                    {page?.extract}\n                  </Typography>\n                  <div className={classes.loaderContainer}>\n                    <Loader />\n                  </div>\n                </>\n              )}\n            </article>\n          ) : (\n            <Typography className={classes.title} variant=\"h5\" component=\"h2\" gutterBottom>\n              ページが選択されていません\n            </Typography>\n          )}\n        </div>\n      </Container>\n    </PageContainer>\n  );\n}\n\nexport default Article;\n","import * as React from 'react';\nimport { useLocation } from 'react-router-dom';\nimport PageContainer from '../../components/PageContainer';\nimport AppStateHandler from '../../components/AppStateHandler';\nimport MapStateHandler from '../../components/MapStateHandler';\nimport ThemeStateHandler from '../../components/ThemeStateHandler';\nimport StateActions from '../../components/StateActions';\nimport Credit from '../../components/Credit';\nimport useGaTrackPage from '../../utils/useGaTrackPage';\n\nfunction Settings(): JSX.Element {\n  const { pathname } = useLocation();\n  useGaTrackPage(pathname);\n  return (\n    <PageContainer>\n      <MapStateHandler />\n      <AppStateHandler />\n      <ThemeStateHandler />\n      <StateActions />\n      <Credit />\n    </PageContainer>\n  );\n}\n\nexport default Settings;\n","import * as React from 'react';\nimport { useLocation } from 'react-router-dom';\nimport Container from '@material-ui/core/Container';\nimport Typography from '@material-ui/core/Typography';\nimport MuiLink, { LinkProps } from '@material-ui/core/Link';\nimport PageContainer from '../../components/PageContainer';\nimport Title from '../../components/Search/Title';\nimport useGaTrackPage from '../../utils/useGaTrackPage';\n\nfunction Link({ children, href }: LinkProps) {\n  return (\n    <MuiLink href={href} color=\"secondary\" target=\"_blank\" rel=\"noopener noreferrer\">\n      {children}\n    </MuiLink>\n  );\n}\n\nfunction About(): JSX.Element {\n  const { pathname } = useLocation();\n  useGaTrackPage(pathname);\n\n  return (\n    <PageContainer>\n      <Container>\n        <Title />\n        <section>\n          <Typography variant=\"h5\" component=\"h2\" gutterBottom>\n            使い方\n          </Typography>\n          <Typography paragraph>\n            WikiLayers は Wikipedia から座標を取得し、地図で表示するアプリケーションです。検索フォームで Wikipedia\n            の記事を検索して、地図に追加してみましょう。\n          </Typography>\n          <Typography variant=\"h6\" component=\"h3\" gutterBottom>\n            地図\n          </Typography>\n          <Typography paragraph>\n            記事を地図に追加すると、アプリケーションの地図に表示されます。画面下部の「地図」タブで地図が表示されます。設定から好きな背景地図を選ぶことができます。\n          </Typography>\n          <Typography variant=\"h6\" component=\"h3\" gutterBottom>\n            読む\n          </Typography>\n          <Typography paragraph>\n            選択した記事はアプリケーション上で読むことができます。画面下部の「読む」タブで記事本文が表示されます。\n          </Typography>\n        </section>\n        <section>\n          <Typography variant=\"h5\" component=\"h2\" gutterBottom>\n            WikiLayers\n          </Typography>\n          <Typography paragraph>\n            このアプリケーションは Wikimedia Foundation の定める\n            <Link href=\"https://wikimediafoundation.org/wiki/Terms_of_Use/ja\">利用規約</Link>、\n            <Link href=\"https://ja.wikipedia.org/wiki/Wikipedia:%E3%82%A6%E3%82%A3%E3%82%AD%E3%83%9A%E3%83%87%E3%82%A3%E3%82%A2%E3%82%92%E4%BA%8C%E6%AC%A1%E5%88%A9%E7%94%A8%E3%81%99%E3%82%8B\">\n              ウィキペディアを二次利用する\n            </Link>\n            、及び<Link href=\"http://www.gsi.go.jp/kikakuchousei/kikakuchousei40182.html\">国土地理院コンテンツ利用規約</Link>\n            に基づき作成されています。\n            <br />\n            Wikipedia を情報源としている部分においては、\n            <Link href=\"http://creativecommons.org/licenses/by-sa/3.0/\">\n              クリエイティブ・コモンズ 表示-継承 3.0 非移植(CC-BY-SA 3.0) ライセンス\n            </Link>\n            に基づき Wikipedia が出典であることを明示して、誰でも自由に利用可能です。\n            <br />\n            地図画面を二次利用する場合は地図画面右下に表示されている地図の帰属を明記してください。\n            <br />\n          </Typography>\n          <Typography variant=\"h6\" component=\"h3\" gutterBottom>\n            制作\n          </Typography>\n          <Typography paragraph>\n            <Link href=\"https://cieloazul310.github.io\">水戸地図</Link>\n          </Typography>\n          <Typography variant=\"h6\" component=\"h3\" gutterBottom>\n            作者\n          </Typography>\n          <Typography paragraph>\n            <Link href=\"https://twitter.com/cieloazul310\">@cieloazul310</Link>\n          </Typography>\n        </section>\n        <footer>\n          <Typography variant=\"body2\" align=\"center\" paragraph>\n            Copyright © 2021 cieloazul310 All right reserved.\n          </Typography>\n        </footer>\n      </Container>\n    </PageContainer>\n  );\n}\n\nexport default About;\n","import * as React from 'react';\nimport { useLocation } from 'react-router-dom';\n\nfunction ScrollToTop() {\n  const { pathname } = useLocation();\n\n  React.useEffect(() => {\n    window.scrollTo(0, 0);\n  }, [pathname]);\n\n  return null;\n}\n\nexport default ScrollToTop;\n","import * as React from 'react';\nimport { BrowserRouter as Router, Route, Switch } from 'react-router-dom';\n\nimport AppStateProvider from './AppStateProvider';\nimport MapProvider from './MapProvider';\n\nimport Layout from './layout';\nimport Map from './pages/Map';\nimport Search from './pages/Search';\nimport Article from './pages/Article';\nimport Settings from './pages/Settings';\nimport About from './pages/About';\nimport ScrollToTop from './utils/ScrollToTop';\n\nfunction App(): JSX.Element {\n  return (\n    <AppStateProvider>\n      <MapProvider>\n        <Router basename=\"/wikilayers\">\n          <ScrollToTop />\n          <Layout>\n            <Switch>\n              <Route path=\"/search\" component={Search} />\n              <Route path=\"/article\" component={Article} />\n              <Route path=\"/settings\" component={Settings} />\n              <Route path=\"/about\" component={About} />\n              <Route path=\"/\" component={Map} />\n            </Switch>\n          </Layout>\n        </Router>\n      </MapProvider>\n    </AppStateProvider>\n  );\n}\n\nexport default App;\n"],"sourceRoot":""}